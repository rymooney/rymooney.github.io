---
title: "Are Malignant Cancer Cells Really Bigger?"
author: "Ryan Mooney"
subtitle: "10 December 2025"
format:
  revealjs:
    scrollable: true
    slide-number: true
    show-slide-number: all
    embed-resources: true
execute:
  echo: true
  warning: false
  message: false
---

## The goal

*Determine if there is a correlation between diagnosis of a tumor and tumor size.*

The method to answer this question: permutation test!

If you are here from my website, and want to go back, please click [here](https://rymooney.github.io/)!

## The data

The data set is from William Wolberg et. al, (1993) in [Biomedical Image Processing and Biomedical Visualization.](https://minds.wisconsin.edu/bitstream/handle/1793/59692/TR1131.pdf;jsessionid=D67421CDB9C9D60F48E00CFD511DD259?sequence=1), which contains data on 568 breast cancer tumor samples. The data set was downloaded from [UC Irvine Machine Learning Repository](https://archive.ics.uci.edu/dataset/17/breast%2Bcancer%2Bwisconsin%2Bdiagnostic?utm_source=chatgpt.com).

```{r}
#| echo: false
library(tidyverse)
library(readr)
```

## What does the data look like?

```{r}
#| message: false
#| warning: false
#| echo: false
tumor_data <- read_csv("data/wdbc.data")

colnames(tumor_data) <- c(
  "id", "diagnosis",
  "radius_mean", "texture_mean", "perimeter_mean", "area_mean", "smoothness_mean",
  "compactness_mean", "concavity_mean", "concave_points_mean", "symmetry_mean", "fractal_dimension_mean",
  
  "radius_se", "texture_se", "perimeter_se", "area_se", "smoothness_se",
  "compactness_se", "concavity_se", "concave_points_se", "symmetry_se", "fractal_dimension_se",
  
  "radius_worst", "texture_worst", "perimeter_worst", "area_worst", "smoothness_worst",
  "compactness_worst", "concavity_worst", "concave_points_worst", "symmetry_worst", "fractal_dimension_worst")
```

```{r}
head(tumor_data)
```
##
![Benign vs Malignant Tumors (National Cancer Institute, 2001)](images/tumor.png){width="60%"}

Major Differences:
Circularity, nucleation, rigidity, size?

## Hypotheses

**The null hypothesis:** benign tumors and malignant tumors have cells of *the same* average area.

**The alternative hypothesis:** malignant tumors have *larger* average cell areas.

## The Variables of Interest and Test Statistic

The variables 
- diagnosis (whether the tumor is malignant or benign), 
    - designated by an 'M' or a 'B' in the diagnosis column 
- mean tumor cell area
    - a calculated value for each sample in the area_mean column.

The *test statistic* is the **difference in means** between area in the benign and malignant tumor samples.

## Let's have a look at the observed test statistic

```{r}
tumor_data |> 
  group_by(diagnosis) |> 
  summarize(ave_area = mean(area_mean))
```

## 

```{r}
#| echo: false
tumor_data |> 
  ggplot(aes(x = diagnosis, y = area_mean)) + 
  geom_boxplot()
```

So, it looks like the mean area of malignant tumor cells is larger than that of benign tumor cells. However, is that **generalizable** to other breast tumors? Off to the permutation test!

## The Permutation Test

```{r}
set.seed(47)
perm_data <- function(rep, data) {
  data |>
    select(diagnosis, area_mean) |>
    mutate(area_perm = sample(area_mean, replace = FALSE)) |>
    group_by(diagnosis) |>
    summarize(
      obs_mean  = mean(area_mean),
      perm_mean = mean(area_perm)) |>
    summarize(
      obs_mean_diff  = diff(obs_mean),
      perm_mean_diff = diff(perm_mean),
      rep = rep
    )
}

map(c(1:1000), perm_data, data = tumor_data) |> 
  list_rbind()
```

## Visualizing the null distribution

```{r}
#| echo: false
set.seed(47)
perm_stats <- 
  map(c(1:1000), perm_data, data = tumor_data) |> 
  list_rbind() 

perm_stats |> 
  ggplot(aes(x = perm_mean_diff)) + 
  geom_histogram(binwidth = 5) + 
  geom_vline(aes(xintercept = obs_mean_diff), color = "red") + 
  labs(
    title = "Null sampling distribution",
    subtitle = "Red line is the observed difference in means",
    x = "Mean Difference"
  )
```

## What's the p value?

```{r}
perm_stats |> 
    summarize(p_val = mean(perm_mean_diff > obs_mean_diff))
```

## Conclusions

The permutation test gave a p-value of 0.

The observed difference in mean cell size between malignant and benign breast tumors was 515.479.

This difference did not occur once in 1,000 random permutations.

The extremely small p-value provides very strong evidence against the null hypothesis.

Therefore, the results suggest that **all** malignant breast cancer cells have larger average sizes than benign breast cancer cells.

## Implications

This means that average cell size could potentially serve as a potential quantitative metric for the rapid and automated classification of tumor malignancy.

## References
“Normal and Cancer Cells Structure: Image Details.” NCI Visuals Online, National Cancer Institute, (2001).  visualsonline.cancer.gov/details.cfm?imageid=2512. 

Street, W.N., Wolberg, W.H., & Mangasarian, O.L. “Nuclear feature extraction for breast tumor diagnosis.” (1993) Proc. SPIE 1905: Biomedical Image Processing and Biomedical Visualization. https://doi.org/10.1117/12.148698

Wolberg, W., Mangasarian, O., Street, N., & Street, W. “Breast Cancer Wisconsin (Diagnostic)” (1993) UCI Machine Learning Repository. https://doi.org/10.24432/C5DW2B
